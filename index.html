<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suite Financiera Integral</title>
    <!-- Librer√≠a SheetJS (xlsx) cargada una sola vez para las herramientas que la necesiten -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Google tag (gtag.js) - COPIADO DE "yoymisfinanzas.html" -->
    <!-- Reemplaza G-XXXXXXXXXX con tu ID de Medici√≥n real en AMBAS l√≠neas -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX');
    </script>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Q1H1XHNQJF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-Q1H1XHNQJF');
</script>
    <style>
        /* --- ESTILOS GENERALES Y DE NAVEGACI√ìN --- */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; margin: 0; padding: 0; }
        .tool-view { display: none; }
        .main-button { display: inline-block; background-color: #007bff; color: white !important; padding: 12px 25px; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1em; font-weight: bold; text-decoration: none; margin-top: 20px; transition: background-color 0.2s; }
        .main-button:hover { background-color: #0056b3; }
        .back-button { display: inline-block; background-color: #6c757d; color: white !important; padding: 12px 25px; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1em; font-weight: bold; text-decoration: none; margin: 20px 0 0 25px; transition: background-color 0.2s; }
        .back-button:hover { background-color: #5a6268; }

        /* --- ESTILOS ORIGINALES DE yoymisfinanzas.html --- */
        #capacitacionView { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f8f9fa; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; line-height: 1.7; color: #333; }
        #capacitacionView .slide { width: 95%; max-width: 950px; margin: 25px 0; padding: 40px; background-color: #ffffff; border-radius: 16px; box-shadow: 0 8px 24px rgba(0,0,0,0.1); text-align: center; }
        #capacitacionView .module-1-header { border-top: 8px solid #f39c12; }
        #capacitacionView .module-2-header { border-top: 8px solid #c0392b; }
        #capacitacionView .module-title { color: white; padding: 25px; border-radius: 12px; margin-bottom: 30px; }
        #capacitacionView .module-title-1 { background-color: #f39c12; }
        #capacitacionView .module-title-2 { background-color: #c0392b; }
        #capacitacionView .module-title h1 { color: white; margin: 0; }
        #capacitacionView .module-title p { margin: 10px 0 0; opacity: 0.9; }
        #capacitacionView h2 { color: #34495e; font-weight: 700; margin-top: 40px; }
        #capacitacionView h3 { color: #34495e; border-bottom: 3px solid #f1c40f; padding-bottom: 8px; display: inline-block; margin-top: 30px; }
        #capacitacionView .concept-box { text-align: left; margin: 20px auto; padding: 25px; background-color: #fdfefe; border-left: 6px solid; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.06); }
        #capacitacionView .quiz-section { background-color: #e6f7ff; border: 2px dashed #007bff; padding: 30px; border-radius: 10px; margin: 40px 0; text-align: left; }
        #capacitacionView .quiz-question { margin-bottom: 25px; }
        #capacitacionView .quiz-question p { font-weight: bold; margin-bottom: 10px; }
        #capacitacionView .quiz-question label { display: block; margin-left: 5px; margin-bottom: 5px; cursor: pointer; }
        #capacitacionView .quiz-feedback { font-weight: bold; margin-left: 10px; font-size: 0.9em; }
        #capacitacionView .feedback-correct { color: #28a745; }
        #capacitacionView .feedback-incorrect { color: #dc3545; }
        #capacitacionView .tool-section { margin-top: 40px; padding: 30px; background-color: #f4f6f7; border-radius: 10px; }
        #capacitacionView table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 0.95em; }
        #capacitacionView th, #capacitacionView td { border: 1px solid #bdc3c7; padding: 12px; text-align: left; }
        #capacitacionView th { background-color: #34495e; color: white; }
        #capacitacionView td input[type="text"], #capacitacionView td input[type="number"] { width: 90%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;}
        #capacitacionView tfoot tr { font-weight: bold; background-color: #ecf0f1; }
        #capacitacionView .transition-slide { background-color: #34495e; color: white; border-top: 8px solid #f1c40f; }
        #capacitacionView .transition-slide h2 { color: white; }
        #capacitacionView .action-icon {cursor:pointer; font-size:1.4em; margin:0 5px; text-decoration:none; display:inline-block; vertical-align: middle;}
        #capacitacionView .action-icon:hover {opacity:0.7;}
        #capacitacionView .tool-section button { background-color: #3498db; color: #fff; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 1em; margin-top: 15px; margin-right: 10px; }
        #capacitacionView .tool-section button:hover { background-color: #2980b9; }
        #capacitacionView .tool-section button.add-row-button { background-color: #28a745; }
        #capacitacionView .tool-section button.add-row-button:hover { background-color: #218838; }

        /* --- ESTILOS ORIGINALES DE Registro mi hogar y mi negocio.html --- */
        #hogarView { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; margin: 0; padding: 25px; color: #333; }
        #hogarView .container { max-width: 1200px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); }
        #hogarView header { text-align: center; margin-bottom: 30px; border-bottom: 4px solid #f39c12; padding-bottom: 20px; }
        #hogarView header h1 { color: #f39c12; margin: 0; }
        #hogarView header p { font-size: 1.1em; color: #555; margin-bottom: 20px;}
        #hogarView #export-btn { background-color: #218838; color: white; padding: 12px 25px; border: none; border-radius: 8px; font-size: 1.1em; cursor: pointer; font-weight: bold; }
        #hogarView #export-btn:hover { background-color: #1e7e34; }
        #hogarView .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; }
        #hogarView .category-card { background-color: #fdfdfd; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; flex-direction: column; }
        #hogarView .category-card h2 { margin-top: 0; font-size: 1.3em; color: #34495e; border-bottom: 2px solid #eeeeee; padding-bottom: 10px; margin-bottom: 15px; }
        #hogarView #ingresos-card h2 { color: #27ae60; }
        #hogarView table { width: 100%; border-collapse: collapse; flex-grow: 1; }
        #hogarView th, #hogarView td { padding: 10px; text-align: left; border-bottom: 1px solid #eee; }
        #hogarView th { font-size: 0.9em; color: #7f8c8d; }
        #hogarView td input { width: 95%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        #hogarView tfoot { font-weight: bold; color: #34495e; }
        #hogarView .add-row-btn { background-color: #7f8c8d; color: white; border: none; padding: 6px 10px; border-radius: 5px; cursor: pointer; margin-top: 15px; align-self: flex-start; font-size: 0.8em; }
        #hogarView .add-row-btn:hover { background-color: #34495e; }
        #hogarView .summary-card { margin-top: 40px; padding: 25px; background-color: #eafaf1; border: 2px solid #28a745; border-radius: 10px; text-align: center; }
        #hogarView .summary-card h2 { color: #28a745; }
        #hogarView .summary-item { margin: 15px 0; font-size: 1.2em; }
        #hogarView #final-balance { font-size: 1.5em; font-weight: bold; }

        /* --- ESTILOS ORIGINALES DE registroyo ymi negocio.html --- */
        #negocioView { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; margin: 0; padding: 25px; color: #333; }
        #negocioView .container { max-width: 1200px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); }
        #negocioView header { text-align: center; margin-bottom: 30px; border-bottom: 4px solid #c0392b; padding-bottom: 20px; }
        #negocioView header h1 { color: #c0392b; margin: 0; }
        #negocioView #export-btn { background-color: #218838; color: white; padding: 12px 25px; border: none; border-radius: 8px; font-size: 1.1em; cursor: pointer; font-weight: bold; margin-top: 20px; }
        #negocioView #export-btn:hover { background-color: #1e7e34; }
        #negocioView .grid-container { display: grid; grid-template-columns: 1fr; gap: 30px; }
        #negocioView .section-card { border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; }
        #negocioView .section-card h2 { margin-top: 0; padding-bottom: 10px; border-bottom: 2px solid; }
        #negocioView #ingresos h2 { color: #27ae60; border-color: #27ae60; }
        #negocioView #costos h2 { color: #f39c12; border-color: #f39c12; }
        #negocioView #gastos h2 { color: #8e44ad; border-color: #8e44ad; }
        #negocioView table { width: 100%; border-collapse: collapse; }
        #negocioView th, #negocioView td { padding: 10px; text-align: left; border-bottom: 1px solid #eee; }
        #negocioView th { font-size: 0.9em; color: #7f8c8d; }
        #negocioView td input { width: 95%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        #negocioView tfoot { font-weight: bold; font-size: 1.1em; }
        #negocioView .add-row-btn { background-color: #3498db; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin-top: 10px; }
        #negocioView .summary-card { margin-top: 30px; padding: 25px; background-color: #ecf0f1; border-top: 5px solid #34495e; border-radius: 10px; }
        #negocioView .summary-card h2 { text-align: center; color: #34495e; }
        #negocioView .summary-item { display: flex; justify-content: space-between; padding: 15px; font-size: 1.2em; border-bottom: 1px solid #bdc3c7; }
        #negocioView .summary-item:last-child { border-bottom: none; }
        #negocioView .summary-item span:last-child { font-weight: bold; }
        #negocioView #resultado-final { font-size: 1.5em; }
    </style>
</head>
<body>

    <!-- =============================================================== -->
    <!-- VISTA 1: CAPACITACI√ìN (yoymisfinanzas.html)                       -->
    <!-- =============================================================== -->
    <div id="capacitacionView">
        <!-- CONTENIDO HTML √çNTEGRO DEL BODY DE yoymisfinanzas.html -->
        <div class="slide module-1-header">
            <div class="module-title module-title-1"><h1>üè† M√≥dulo 1: Mi Hogar y mi Dinero</h1><p><strong>Objetivo:</strong> Aprender a ordenar nuestro dinero para usarlo adecuadamente, tomar decisiones informadas y definir metas de ahorro para una vida pr√≥spera.</p></div>
            <h3>1. ¬øC√≥mo se hace? El Control de Ingresos y Egresos</h3><div class="concept-box" style="border-left-color: #f39c12;"><ol><li><strong>Revise sus Ingresos:</strong> Sepa de d√≥nde viene su dinero.</li><li><strong>Identifique sus Gastos:</strong> Sepa a d√≥nde se va su dinero.</li><li><strong>Tome Decisiones:</strong> Adapte sus egresos a sus ingresos y metas.</li></ol></div>
            <h3>2. Los Ingresos: ¬øDe d√≥nde viene mi dinero?</h3><div class="concept-box" style="border-left-color: #27ae60;"><strong>Definici√≥n:</strong> Son todas las entradas de dinero a su hogar. Es crucial identificar su <strong>tipo</strong> y su <strong>periodicidad</strong> (quincenal, mensual, etc.) para saber si son fijos o variables.<ul><li><strong>Sueldo/Salario:</strong> Ingreso fijo que se recibe por un trabajo.</li><li><strong>Negocio Familiar:</strong> Ingreso que puede ser variable, proveniente de su emprendimiento.</li><li><strong>Remesas, Apoyos, Bonos:</strong> Otros tipos de ingresos que pueden ser fijos o espor√°dicos.</li></ul></div>
            <h3>3. Los Egresos: ¬øA d√≥nde se va mi dinero?</h3><div class="concept-box" style="border-left-color: #e74c3c;"><strong>Definici√≥n:</strong> Son todas las salidas de dinero. La clave est√° en clasificarlos para saber d√≥nde podemos ajustar. La cartilla los organiza en categor√≠as claras:<ul><li><strong>Vivienda y Servicios:</strong> Arriendo, luz, agua, gas. Suelen ser gastos fijos.</li><li><strong>Transporte y Alimentaci√≥n:</strong> Gastos necesarios pero variables. Aqu√≠ hay oportunidad de optimizar.</li><li><strong>Cr√©ditos/Pr√©stamos:</strong> Deudas adquiridas. Son compromisos fijos.</li><li><strong>Gustos y Entretenimiento:</strong> Gastos discrecionales, los m√°s f√°ciles de ajustar.</li><li><strong>Ahorro:</strong> ¬°El egreso m√°s importante! No es un gasto, es una inversi√≥n en su futuro. La cartilla nos ense√±a a tratarlo como una salida de dinero fija para asegurar que se cumpla.</li></ul></div>
            <div class="tool-section"><h2>üõ†Ô∏è Herramienta Pr√°ctica: Tu Organizador Personal Anual</h2><p>Anota tus compromisos de pago fijos. Usa los iconos de acciones para crear recordatorios en tu calendario preferido. Los totales se calcular√°n autom√°ticamente.</p><table id="hogar-table"><thead><tr><th>Concepto de Pago</th><th>D√≠a L√≠mite</th><th>Monto Aproximado</th><th>Acciones</th></tr></thead><tbody id="cuerpo-organizador"><tr><td><input type="text" class="concepto-organizador" value="Arriendo / Hipoteca"></td><td><input type="number" class="dia-organizador" min="1" max="31" value="5"></td><td><input type="number" class="monto-organizador" placeholder="600000" oninput="calculateOrganizador()"></td><td><a title="A√±adir a Google Calendar" class="action-icon" onclick="createCalendarLink(this)">üìÖ</a><a title="Descargar Recordatorio (.ics)" class="action-icon" onclick="downloadICS(this)">üíæ</a></td></tr><tr><td><input type="text" class="concepto-organizador" value="Servicio de Luz"></td><td><input type="number" class="dia-organizador" min="1" max="31" value="15"></td><td><input type="number" class="monto-organizador" placeholder="80000" oninput="calculateOrganizador()"></td><td><a title="A√±adir a Google Calendar" class="action-icon" onclick="createCalendarLink(this)">üìÖ</a><a title="Descargar Recordatorio (.ics)" class="action-icon" onclick="downloadICS(this)">üíæ</a></td></tr><tr><td><input type="text" class="concepto-organizador" value="Servicio de Agua"></td><td><input type="number" class="dia-organizador" min="1" max="31" value="20"></td><td><input type="number" class="monto-organizador" placeholder="50000" oninput="calculateOrganizador()"></td><td><a title="A√±adir a Google Calendar" class="action-icon" onclick="createCalendarLink(this)">üìÖ</a><a title="Descargar Recordatorio (.ics)" class="action-icon" onclick="downloadICS(this)">üíæ</a></td></tr><tr><td><input type="text" class="concepto-organizador" value="Cr√©dito Personal"></td><td><input type="number" class="dia-organizador" min="1" max="31" value="10"></td><td><input type="number" class="monto-organizador" placeholder="250000" oninput="calculateOrganizador()"></td><td><a title="A√±adir a Google Calendar" class="action-icon" onclick="createCalendarLink(this)">üìÖ</a><a title="Descargar Recordatorio (.ics)" class="action-icon" onclick="downloadICS(this)">üíæ</a></td></tr><tr><td><input type="text" class="concepto-organizador" value="Matr√≠cula / Pensi√≥n"></td><td><input type="number" class="dia-organizador" min="1" max="31" value="30"></td><td><input type="number" class="monto-organizador" placeholder="150000" oninput="calculateOrganizador()"></td><td><a title="A√±adir a Google Calendar" class="action-icon" onclick="createCalendarLink(this)">üìÖ</a><a title="Descargar Recordatorio (.ics)" onclick="downloadICS(this)">üíæ</a></td></tr></tbody><tfoot><tr><td colspan="3" style="text-align:right; font-weight:bold;">Total de Compromisos Fijos:</td><td style="font-weight:bold;">$<span id="total-hogar">0</span></td></tr></tfoot></table><button type="button" onclick="addOrganizadorRow()" class="add-row-button">‚ûï A√±adir Compromiso</button></div>
            <div class="quiz-section"><h2>üéØ Test de Autoevaluaci√≥n del M√≥dulo 1</h2><div class="quiz-question" id="q1-1"><p>1. Seg√∫n la cartilla, el ahorro debe ser considerado un:</p><label><input type="radio" name="q1-1" value="a"> a) Gasto innecesario.</label><label><input type="radio" name="q1-1" value="b"> b) Egreso planificado y prioritario.</label><label><input type="radio" name="q1-1" value="c"> c) Lo que sobra al final del mes.</label><span class="quiz-feedback"></span></div><div class="quiz-question" id="q1-2"><p>2. Identificar la periodicidad de un ingreso (quincenal, mensual) te ayuda a:</p><label><input type="radio" name="q1-2" value="a"> a) Saber cu√°nto gastar en gustos.</label><label><input type="radio" name="q1-2" value="b"> b) Identificar si tus ingresos son fijos o variables y planificar tu flujo de caja.</label><label><input type="radio" name="q1-2" value="c"> c) Pedir m√°s cr√©ditos.</label><span class="quiz-feedback"></span></div><div class="quiz-question" id="q1-3"><p>3. Los "gastos hormiga" son:</p><label><input type="radio" name="q1-3" value="a"> a) Los pagos m√°s grandes del mes, como el arriendo.</label><label><input type="radio" name="q1-3" value="b"> b) Peque√±os gastos diarios que, sumados, afectan significativamente el presupuesto.</label><label><input type="radio" name="q1-3" value="c"> c) Ahorros peque√±os que se hacen todos los d√≠as.</label><span class="quiz-feedback"></span></div><div class="quiz-question" id="q1-4"><p>4. ¬øVerdadero o Falso? Un presupuesto sirve para restringir todos mis gastos y no poder disfrutar del dinero.</p><label><input type="radio" name="q1-4" value="a"> a) Verdadero.</label><label><input type="radio" name="q1-4" value="b"> b) Falso.</label><span class="quiz-feedback"></span></div></div>
             <!-- BOT√ìN DE NAVEGACI√ìN -->
             <button class="main-button" onclick="showView('hogarView')">Abrir Herramienta de Registro del Hogar</button>
        </div>
        <div class="slide transition-slide">
            <h2>¬°Felicidades! Has sentado las bases para un hogar financieramente saludable.</h2>
            <p>Ahora, apliquemos este mismo rigor y claridad a tu negocio, la fuente de tu crecimiento.</p>
        </div>
        <div class="slide module-2-header">
            <div class="module-title module-title-2"><h1>üè≠ M√≥dulo 2: Yo y mi Negocio</h1><p><strong>Objetivo:</strong> Llevar un control detallado de ingresos, costos y gastos para entender si el negocio gana o pierde dinero y tomar decisiones acertadas.</p></div>
            <h3>1. Los 3 Conceptos Clave del Negocio</h3><div class="concept-box" style="border-left-color: #2980b9;"><strong>A. Ingresos (Ventas) üìà:</strong> Es el dinero recibido por <strong>vender un producto o brindar un servicio</strong>. Es el motor del negocio.</div><div class="concept-box" style="border-left-color: #e74c3c;"><strong>B. Costos üì¶:</strong> Son <strong>TODOS los elementos usados directamente en la fabricaci√≥n de un producto o para brindar un servicio</strong>. Si no hay venta, no hay costo. <em>Ejemplo de la cartilla: para un puesto de jugos, los costos son las frutas, el az√∫car, los vasos, el hielo.</em></div><div class="concept-box" style="border-left-color: #8e44ad;"><strong>C. Gastos üîå:</strong> Son <strong>TODOS los elementos que hacen funcionar el negocio</strong>, independientemente de si vendes o no. <em>Ejemplo de la cartilla: el salario de quien atiende (¬°aunque seas t√∫ misma!), la luz, el agua, el alquiler.</em></div>
            <h3>2. La F√≥rmula del √âxito: El Estado de Resultados</h3><div class="concept-box" style="border-left-color: #16a085;">El estado de resultados, o de p√©rdidas y ganancias, es la operaci√≥n matem√°tica que te dice la verdad sobre tu negocio.<p style="font-size: 1.4em; text-align: center; font-weight: bold; color: #16a085; margin-top:15px;">Ingresos - (Costos + Gastos) = Resultado Mensual</p>Un resultado positivo es <strong>GANANCIA</strong>. Un resultado negativo es <strong>P√âRDIDA</strong>.</div>
            <div class="tool-section"><h2>üõ†Ô∏è Herramienta Pr√°ctica: Tu Estado de Resultados Anual (Calcula Autom√°ticamente)</h2><p>Ingresa los totales de cada mes. La tabla calcular√° los egresos, el resultado mensual y el resultado anual al instante.</p><table id="negocio-table"><thead><tr><th>Mes</th><th>Ingresos (Ventas)</th><th>Costos</th><th>Gastos</th><th>Egresos Totales (C+G)</th><th>Resultado Mensual (I-E)</th></tr></thead><tbody></tbody><tfoot><tr><td colspan="5">RESULTADO ANUAL</td><td id="resultado-anual">$ 0</td></tr></tfoot></table></div>
            <div class="quiz-section"><h2>üéØ Test de Autoevaluaci√≥n del M√≥dulo 2</h2><div class="quiz-question" id="q2-1"><p>1. La materia prima para fabricar tu producto (ej. la tela para una falda) es un:</p><label><input type="radio" name="q2-1" value="a"> a) Gasto.</label><label><input type="radio" name="q2-1" value="b"> b) Costo.</label><label><input type="radio" name="q2-1" value="c"> c) Ingreso.</label><span class="quiz-feedback"></span></div><div class="quiz-question" id="q2-2"><p>2. El salario que te pagas a ti misma debe ser registrado en la contabilidad de tu negocio como un:</p><label><input type="radio" name="q2-2" value="a"> a) Gasto Operativo.</label><label><input type="radio" name="q2-2" value="b"> b) Utilidad.</label><label><input type="radio" name="q2-2" value="c"> c) Costo de Venta.</label><span class="quiz-feedback"></span></div><div class="quiz-question" id="q2-3"><p>3. ¬øCu√°l es el principal motivo para separar las finanzas del negocio y las personales?</p><label><input type="radio" name="q2-3" value="a"> a) Para pagar menos impuestos.</label><label><input type="radio" name="q2-3" value="b"> b) Para poder saber con certeza si el negocio est√° generando ganancias o p√©rdidas reales.</label><label><input type="radio" name="q2-3" value="c"> c) Es una recomendaci√≥n, pero no es realmente importante.</label><span class="quiz-feedback"></span></div><div class="quiz-question" id="q2-4"><p>4. ¬øVerdadero o Falso? Las ganancias (utilidad) del negocio son mi dinero y puedo gastarlas libremente en mis asuntos personales.</p><label><input type="radio" name="q2-4" value="a"> a) Verdadero.</label><label><input type="radio" name="q2-4" value="b"> b) Falso.</label><span class="quiz-feedback"></span></div></div>
             <!-- BOT√ìN DE NAVEGACI√ìN -->
             <button class="main-button" onclick="showView('negocioView')">Abrir Herramienta de Registro del Negocio</button>
        </div>
    </div>

    <!-- =============================================================== -->
    <!-- VISTA 2: PRESUPUESTO HOGAR (Registro mi hogar y mi negocio.html) -->
    <!-- =============================================================== -->
    <div id="hogarView" class="tool-view">
        <button class="back-button" onclick="showView('capacitacionView')">‚Üê Volver a la Capacitaci√≥n</button>
        <!-- CONTENIDO HTML √çNTEGRO DEL BODY DE Registro mi hogar y mi negocio.html -->
        <div class="container"><header><h1>üè† Herramienta de Presupuesto: Mi Hogar y mi Dinero</h1><p>Registra tus ingresos y gastos para tener un control claro de tus finanzas personales.</p><button id="export-btn">üìÑ Exportar a Excel (.xlsx)</button></header><div class="category-card" id="ingresos-card"><h2>üí∞ Ingresos del Hogar</h2><table id="ingresos-table"><thead><tr><th>Concepto</th><th>Monto</th></tr></thead><tbody><tr><td><input type="text" placeholder="Ej: Salario Quincena 1"></td><td><input class="monto-input" type="number" placeholder="0"></td></tr><tr><td><input type="text" placeholder="Ej: Apoyo familiar"></td><td><input class="monto-input" type="number" placeholder="0"></td></tr></tbody><tfoot><tr><td><strong>Total Ingresos</strong></td><td class="subtotal"><strong>$ 0</strong></td></tr></tfoot></table><button class="add-row-btn">+ A√±adir Fila</button></div><hr style="margin: 40px 0; border: 1px solid #eee;"><div class="grid-container"><div class="category-card expense-card" id="vivienda"><h2>Vivienda y Servicios</h2><table id="vivienda-table"><thead><tr><th>D√≠a</th><th>Concepto</th><th>Monto</th></tr></thead><tbody><tr><td><input type="text"></td><td><input type="text" value="Arriendo"></td><td><input class="monto-input" type="number" placeholder="0"></td></tr><tr><td><input type="text"></td><td><input type="text" value="Luz"></td><td><input class="monto-input" type="number" placeholder="0"></td></tr></tbody><tfoot><tr><td colspan="2">Subtotal</td><td class="subtotal">$ 0</td></tr></tfoot></table><button class="add-row-btn">+ A√±adir Fila</button></div><div class="category-card expense-card" id="transporte"><h2>Transporte</h2><table id="transporte-table"><thead><tr><th>D√≠a</th><th>Concepto</th><th>Monto</th></tr></thead><tbody><tr><td><input type="text"></td><td><input type="text" value="Gasolina"></td><td><input class="monto-input" type="number" placeholder="0"></td></tr></tbody><tfoot><tr><td colspan="2">Subtotal</td><td class="subtotal">$ 0</td></tr></tfoot></table><button class="add-row-btn">+ A√±adir Fila</button></div><div class="category-card expense-card" id="alimentacion"><h2>Alimentaci√≥n</h2><table id="alimentacion-table"><thead><tr><th>D√≠a</th><th>Concepto</th><th>Monto</th></tr></thead><tbody><tr><td><input type="text"></td><td><input type="text" value="Mercado"></td><td><input class="monto-input" type="number" placeholder="0"></td></tr></tbody><tfoot><tr><td colspan="2">Subtotal</td><td class="subtotal">$ 0</td></tr></tfoot></table><button class="add-row-btn">+ A√±adir Fila</button></div><div class="category-card expense-card" id="creditos"><h2>Cr√©ditos/Pr√©stamo Personal</h2><table id="creditos-table"><thead><tr><th>D√≠a</th><th>Concepto</th><th>Monto</th></tr></thead><tbody><tr><td><input type="text"></td><td><input type="text" value="Cuota Pr√©stamo"></td><td><input class="monto-input" type="number" placeholder="0"></td></tr></tbody><tfoot><tr><td colspan="2">Subtotal</td><td class="subtotal">$ 0</td></tr></tfoot></table><button class="add-row-btn">+ A√±adir Fila</button></div><div class="category-card expense-card" id="ahorro"><h2>Ahorro</h2><table id="ahorro-table"><thead><tr><th>D√≠a</th><th>Concepto</th><th>Monto</th></tr></thead><tbody><tr><td><input type="text"></td><td><input type="text" value="Ahorro Meta 1"></td><td><input class="monto-input" type="number" placeholder="0"></td></tr></tbody><tfoot><tr><td colspan="2">Subtotal</td><td class="subtotal">$ 0</td></tr></tfoot></table><button class="add-row-btn">+ A√±adir Fila</button></div><div class="category-card expense-card" id="otros"><h2>Otros / Imprevistos</h2><table id="otros-table"><thead><tr><th>D√≠a</th><th>Concepto</th><th>Monto</th></tr></thead><tbody><tr><td><input type="text"></td><td><input type="text"></td><td><input class="monto-input" type="number" placeholder="0"></td></tr></tbody><tfoot><tr><td colspan="2">Subtotal</td><td class="subtotal">$ 0</td></tr></tfoot></table><button class="add-row-btn">+ A√±adir Fila</button></div></div><div class="summary-card"><h2>Resumen Financiero del Mes</h2><div class="summary-item"><strong>Total de Ingresos del Mes:</strong> <span id="summary-ingresos">$ 0</span></div><div class="summary-item"><strong>Gran Total de Egresos (Gastos + Ahorro):</strong> <span id="summary-egresos">$ 0</span></div><hr><div class="summary-item"><strong>Resultado del Mes:</strong> <span id="final-balance">$ 0</span></div></div></div>
    </div>

    <!-- =============================================================== -->
    <!-- VISTA 3: ESTADO DE RESULTADOS (registroyo ymi negocio.html)       -->
    <!-- =============================================================== -->
    <div id="negocioView" class="tool-view">
        <button class="back-button" onclick="showView('capacitacionView')">‚Üê Volver a la Capacitaci√≥n</button>
        <!-- CONTENIDO HTML √çNTEGRO DEL BODY DE registroyo ymi negocio.html -->
        <div class="container"><header><h1>üè≠ Registro de Cuentas de Mi Negocio</h1><p>Registra tus ventas, costos y gastos para calcular la ganancia de tu negocio al instante.</p><button id="export-btn">üìÑ Exportar a Excel (.xlsx)</button></header><div class="grid-container"><div class="section-card" id="ingresos"><h2>üìà Ingresos por Ventas</h2><table id="ingresos-table"><thead><tr><th>D√≠a</th><th>Concepto / Art√≠culo</th><th>Cantidad</th><th>Precio ($)</th><th>Venta Total ($)</th></tr></thead><tbody></tbody><tfoot><tr><td colspan="4">TOTAL INGRESOS (VENTAS)</td><td class="total-ingresos">$ 0</td></tr></tfoot></table><button class="add-row-btn">+ A√±adir Fila</button></div><div class="section-card" id="costos"><h2>üì¶ Costos del Negocio</h2><table id="costos-table"><thead><tr><th>D√≠a</th><th>Concepto / Art√≠culo</th><th>Cantidad</th><th>Precio ($)</th><th>Costo Total ($)</th></tr></thead><tbody></tbody><tfoot><tr><td colspan="4">TOTAL COSTOS</td><td class="total-costos">$ 0</td></tr></tfoot></table><button class="add-row-btn">+ A√±adir Fila</button></div><div class="section-card" id="gastos"><h2>üîå Gastos del Negocio</h2><table id="gastos-table"><thead><tr><th>D√≠a</th><th>Concepto / Art√≠culo</th><th>Cantidad</th><th>Precio ($)</th><th>Gasto Total ($)</th></tr></thead><tbody></tbody><tfoot><tr><td colspan="4">TOTAL GASTOS</td><td class="total-gastos">$ 0</td></tr></tfoot></table><button class="add-row-btn">+ A√±adir Fila</button></div></div><div class="summary-card"><h2>Estado de Resultados Mensual</h2><div class="summary-item"><span>Total Ingresos (Ventas)</span><span class="total-ingresos">$ 0</span></div><div class="summary-item"><span>Total Egresos (Costos + Gastos)</span><span id="total-egresos">$ 0</span></div><hr style="border: 1px solid #34495e;"><div class="summary-item"><span><strong>RESULTADO MENSUAL</strong></span><span id="resultado-final">$ 0</span></div></div></div>
    </div>

<script>
    // ===================================================================
    // SCRIPT DE NAVEGACI√ìN PRINCIPAL
    // ===================================================================
    function showView(viewId) {
        document.getElementById('capacitacionView').style.display = 'none';
        document.getElementById('hogarView').style.display = 'none';
        document.getElementById('negocioView').style.display = 'none';
        document.getElementById(viewId).style.display = 'block';
        window.scrollTo(0, 0);
    }
    document.addEventListener('DOMContentLoaded', () => { 
        showView('capacitacionView'); 
        // Inicializar los scripts de las otras vistas para que sus listeners est√©n listos
        initHogarScript();
        initNegocioScript();
    });

    // ===================================================================
    // SCRIPT ORIGINAL DE yoymisfinanzas.html (AISLADO)
    // ===================================================================
    (() => {
        const view = document.getElementById('capacitacionView');
        const formatCurrency = (value) => new Intl.NumberFormat('es-CO', { style: 'currency', currency: 'COP', minimumFractionDigits: 0 }).format(value);
        const totalHogarCell = view.querySelector('#total-hogar');
        
        // CORRECCI√ìN: Funciones asignadas a window para ser accesibles desde onclick
        window.calculateOrganizador = function() { const montos = view.querySelectorAll('#cuerpo-organizador .monto-organizador'); let total = 0; montos.forEach(input => { total += parseFloat(input.value) || 0; }); totalHogarCell.textContent = formatCurrency(total); if (typeof gtag === 'function') { gtag('event', 'calculate_total', { 'event_category': 'organizador_personal', 'value': total }); } };
        window.addOrganizadorRow = function() { const tbody = view.querySelector('#cuerpo-organizador'); const newRow = document.createElement('tr'); newRow.innerHTML = `<td><input type="text" class="concepto-organizador" placeholder="Nuevo Concepto"></td><td><input type="number" class="dia-organizador" min="1" max="31"></td><td><input type="number" class="monto-organizador" placeholder="0" oninput="calculateOrganizador()"></td><td><a title="A√±adir a Google Calendar" class="action-icon" onclick="createCalendarLink(this)">üìÖ</a><a title="Descargar Recordatorio (.ics)" class="action-icon" onclick="downloadICS(this)">üíæ</a></td>`; tbody.appendChild(newRow); calculateOrganizador(); if (typeof gtag === 'function') { gtag('event', 'add_row', { 'event_category': 'organizador_personal' }); } };
        window.createCalendarLink = function(element) { const row = element.closest('tr'); const concepto = row.querySelector('.concepto-organizador').value || 'Pago'; const dia = parseInt(row.querySelector('.dia-organizador').value); const monto = parseFloat(row.querySelector('.monto-organizador').value) || 0; if (!concepto || isNaN(dia) || dia < 1 || dia > 31) { alert('Por favor, complete un concepto v√°lido y un d√≠a l√≠mite (1-31) para crear un recordatorio.'); return; } const getNextEventDate = (diaLimite) => { const hoy = new Date(); let anioEvento = hoy.getFullYear(); let mesEvento = hoy.getMonth(); let diasEnMes = new Date(anioEvento, mesEvento + 1, 0).getDate(); let diaValido = Math.min(diaLimite, diasEnMes); if (hoy.getDate() > diaValido) { mesEvento += 1; if (mesEvento > 11) { mesEvento = 0; anioEvento += 1; } } return new Date(anioEvento, mesEvento, diaValido); }; const formatDateForCalendar = (date) => { const anio = date.getFullYear(); const mes = String(date.getMonth() + 1).padStart(2, '0'); const dia = String(date.getDate()).padStart(2, '0'); return `${anio}${mes}${dia}`; }; const eventDate = getNextEventDate(dia); const formattedDate = formatDateForCalendar(eventDate); const eventTitle = encodeURIComponent(`Recordatorio de Pago: ${concepto}`); const eventDetails = encodeURIComponent(`No olvides realizar el pago de "${concepto}" por un monto aproximado de $${monto.toLocaleString('es-CO')}.`); const googleCalendarUrl = `https://www.google.com/calendar/render?action=TEMPLATE&text=${eventTitle}&dates=${formattedDate}/${formattedDate}&details=${eventDetails}&allDay=true`; window.open(googleCalendarUrl, '_blank'); if (typeof gtag === 'function') { gtag('event', 'create_reminder', { 'event_category': 'organizador_personal', 'event_label': 'Google Calendar', 'reminder_concept': concepto }); } };
        window.downloadICS = function(element) { const row = element.closest('tr'); const concepto = row.querySelector('.concepto-organizador').value || 'Pago'; const dia = parseInt(row.querySelector('.dia-organizador').value); const monto = parseFloat(row.querySelector('.monto-organizador').value) || 0; if (!concepto || isNaN(dia) || dia < 1 || dia > 31) { alert('Por favor, complete un concepto v√°lido y un d√≠a l√≠mite (1-31) para crear un recordatorio.'); return; } const getNextEventDate = (diaLimite) => { const hoy = new Date(); let anioEvento = hoy.getFullYear(); let mesEvento = hoy.getMonth(); let diasEnMes = new Date(anioEvento, mesEvento + 1, 0).getDate(); let diaValido = Math.min(diaLimite, diasEnMes); if (hoy.getDate() > diaValido) { mesEvento += 1; if (mesEvento > 11) { mesEvento = 0; anioEvento += 1; } } return new Date(anioEvento, mesEvento, diaValido); }; const formatDateForCalendar = (date) => { const anio = date.getFullYear(); const mes = String(date.getMonth() + 1).padStart(2, '0'); const dia = String(date.getDate()).padStart(2, '0'); return `${anio}${mes}${dia}`; }; const eventDate = getNextEventDate(dia); const formattedDate = formatDateForCalendar(eventDate); const icsContent = ['BEGIN:VCALENDAR', 'VERSION:2.0', 'BEGIN:VEVENT', `DTSTART;VALUE=DATE:${formattedDate}`, `DTEND;VALUE=DATE:${formattedDate}`, `SUMMARY:Recordatorio de Pago: ${concepto}`, `DESCRIPTION:No olvides realizar el pago de "${concepto}" por un monto aproximado de $${monto.toLocaleString('es-CO')}.`, 'END:VEVENT', 'END:VCALENDAR'].join('\n'); const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' }); const link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = `recordatorio_${concepto.replace(/\s/g, '_').replace(/[^a-zA-Z0-9_]/g, '')}.ics`; document.body.appendChild(link); link.click(); document.body.removeChild(link); URL.revokeObjectURL(link.href); if (typeof gtag === 'function') { gtag('event', 'create_reminder', { 'event_category': 'organizador_personal', 'event_label': 'ICS Download', 'reminder_concept': concepto }); } };
        
        const negocioTableBody = view.querySelector('#negocio-table tbody'); const resultadoAnualCell = view.querySelector('#resultado-anual'); const meses = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
        meses.forEach(mes => { const row = document.createElement('tr'); row.innerHTML = `<td>${mes}</td><td><input type="number" class="negocio-input" data-mes="${mes}" data-tipo="ingresos" placeholder="0"></td><td><input type="number" class="negocio-input" data-mes="${mes}" data-tipo="costos" placeholder="0"></td><td><input type="number" class="negocio-input" data-mes="${mes}" data-tipo="gastos" placeholder="0"></td><td id="egresos-${mes}">$ 0</td><td id="resultado-${mes}">$ 0</td>`; negocioTableBody.appendChild(row); });
        function updateNegocioTable() { let totalAnual = 0; meses.forEach(mes => { const ingresos = parseFloat(view.querySelector(`[data-mes="${mes}"][data-tipo="ingresos"]`).value) || 0; const costos = parseFloat(view.querySelector(`[data-mes="${mes}"][data-tipo="costos"]`).value) || 0; const gastos = parseFloat(view.querySelector(`[data-mes="${mes}"][data-tipo="gastos"]`).value) || 0; const egresosTotales = costos + gastos; const resultadoMensual = ingresos - egresosTotales; totalAnual += resultadoMensual; view.querySelector(`#egresos-${mes}`).textContent = formatCurrency(egresosTotales); const resultadoCell = view.querySelector(`#resultado-${mes}`); resultadoCell.textContent = formatCurrency(resultadoMensual); resultadoCell.style.color = resultadoMensual < 0 ? '#dc3545' : '#28a745'; }); resultadoAnualCell.textContent = formatCurrency(totalAnual); resultadoAnualCell.style.color = totalAnual < 0 ? '#dc3545' : '#28a745'; }
        view.querySelectorAll('.negocio-input').forEach(input => { input.addEventListener('input', updateNegocioTable); });
        
        const quizAnswers = { 'q1-1': 'b', 'q1-2': 'b', 'q1-3': 'b', 'q1-4': 'b', 'q2-1': 'b', 'q2-2': 'a', 'q2-3': 'b', 'q2-4': 'b' }; view.querySelectorAll('.quiz-question').forEach(questionDiv => { const questionId = questionDiv.id; const radios = questionDiv.querySelectorAll(`input[name="${questionId}"]`); const feedbackSpan = questionDiv.querySelector('.quiz-feedback'); radios.forEach(radio => { radio.addEventListener('change', () => { if (radio.value === quizAnswers[questionId]) { feedbackSpan.textContent = '¬°Correcto!'; feedbackSpan.className = 'quiz-feedback feedback-correct'; } else { feedbackSpan.textContent = 'Incorrecto. ¬°Intenta de nuevo!'; feedbackSpan.className = 'quiz-feedback feedback-incorrect'; } }); }); });
        
        calculateOrganizador(); updateNegocioTable();
    })();

    // ===================================================================
    // SCRIPT ORIGINAL DE Registro mi hogar y mi negocio.html (AISLADO)
    // ===================================================================
    function initHogarScript() {
        const view = document.getElementById('hogarView');
        const formatCurrency = (value) => new Intl.NumberFormat('es-CO', { style: 'currency', currency: 'COP', minimumFractionDigits: 0 }).format(value);
        function calculateAllTotals() { let totalIngresos = 0; view.querySelectorAll('#ingresos-card .monto-input').forEach(input => { totalIngresos += parseFloat(input.value) || 0; }); view.querySelector('#ingresos-card .subtotal').textContent = formatCurrency(totalIngresos); let granTotalEgresos = 0; view.querySelectorAll('.expense-card').forEach(card => { let subtotal = 0; card.querySelectorAll('.monto-input').forEach(input => { subtotal += parseFloat(input.value) || 0; }); card.querySelector('.subtotal').textContent = formatCurrency(subtotal); granTotalEgresos += subtotal; }); const balance = totalIngresos - granTotalEgresos; view.querySelector('#summary-ingresos').textContent = formatCurrency(totalIngresos); view.querySelector('#summary-egresos').textContent = formatCurrency(granTotalEgresos); const balanceElement = view.querySelector('#final-balance'); balanceElement.textContent = formatCurrency(balance); balanceElement.style.color = balance < 0 ? '#e74c3c' : '#2ecc71'; balanceElement.textContent += balance < 0 ? ' (Faltante)' : ' (Excedente)'; }
        view.addEventListener('input', function(event) { if (event.target.classList.contains('monto-input')) { calculateAllTotals(); } });
        view.addEventListener('click', function(event) { if (event.target.classList.contains('add-row-btn')) { const button = event.target; const card = button.closest('.category-card'); const tableBody = card.querySelector('tbody'); const isIncome = card.id === 'ingresos-card'; const newRow = tableBody.insertRow(); if (isIncome) { newRow.innerHTML = `<td><input type="text" placeholder="Otro Ingreso"></td><td><input class="monto-input" type="number" placeholder="0"></td>`; } else { newRow.innerHTML = `<td><input type="text"></td><td><input type="text"></td><td><input class="monto-input" type="number" placeholder="0"></td>`; } } });
        view.querySelector('#export-btn').addEventListener('click', function() { try { const wb = XLSX.utils.book_new(); let totalIngresos = 0; view.querySelectorAll('#ingresos-card .monto-input').forEach(input => { const valor = parseFloat(input.value); if (!isNaN(valor)) totalIngresos += valor; }); let granTotalEgresos = 0; view.querySelectorAll('.expense-card .monto-input').forEach(input => { const valor = parseFloat(input.value); if (!isNaN(valor)) granTotalEgresos += valor; }); const balanceFinal = totalIngresos - granTotalEgresos; const resumenData = [ ["Concepto", "Monto"], ["Total Ingresos del Mes", totalIngresos], ["Gran Total de Egresos", granTotalEgresos], ["Resultado del Mes", balanceFinal] ]; const wsResumen = XLSX.utils.aoa_to_sheet(resumenData); XLSX.utils.book_append_sheet(wb, wsResumen, "Resumen Financiero"); const ingresosData = [["Concepto", "Monto"]]; const ingresosRows = view.querySelectorAll('#ingresos-table tbody tr'); ingresosRows.forEach(row => { const inputs = row.querySelectorAll('input'); if (inputs.length >= 2) { const concepto = inputs[0].value || ""; const monto = parseFloat(inputs[1].value) || 0; if (concepto || monto > 0) { ingresosData.push([concepto, monto]); } } }); const wsIngresos = XLSX.utils.aoa_to_sheet(ingresosData); XLSX.utils.book_append_sheet(wb, wsIngresos, "Ingresos"); const expenseCards = view.querySelectorAll('.expense-card'); expenseCards.forEach(card => { const h2 = card.querySelector('h2'); if (!h2) return; const categoryName = h2.textContent.trim(); const expenseData = [["D√≠a", "Concepto", "Monto"]]; const rows = card.querySelectorAll('tbody tr'); rows.forEach(row => { const inputs = row.querySelectorAll('input'); if (inputs.length >= 3) { const dia = inputs[0].value || ""; const concepto = inputs[1].value || ""; const monto = parseFloat(inputs[2].value) || 0; if (dia || concepto || monto > 0) { expenseData.push([dia, concepto, monto]); } } }); if (expenseData.length > 1) { const cleanName = categoryName.replace(/[:\\/\[\]*?]/g, '').substring(0, 30); const ws = XLSX.utils.aoa_to_sheet(expenseData); XLSX.utils.book_append_sheet(wb, ws, cleanName); } }); const monthName = new Date().toLocaleString('es-ES', { month: 'long' }); const year = new Date().getFullYear(); XLSX.writeFile(wb, `Presupuesto_Hogar_${monthName}_${year}.xlsx`); } catch (error) { console.error('Error al exportar:', error); alert('Hubo un error al exportar el archivo. Por favor verifica los datos e intenta nuevamente.'); } });
        calculateAllTotals();
    }

    // ===================================================================
    // SCRIPT ORIGINAL DE registroyo ymi negocio.html (AISLADO)
    // ===================================================================
    function initNegocioScript() {
        const view = document.getElementById('negocioView');
        const container = view.querySelector('.container');
        const formatCurrency = (value) => new Intl.NumberFormat('es-CO', { style: 'currency', currency: 'COP', minimumFractionDigits: 0 }).format(value);
        let totalIngresosGlobal = 0, totalCostosGlobal = 0, totalGastosGlobal = 0;
        function createRow() { const row = document.createElement('tr'); row.innerHTML = `<td><input type="text"></td><td><input type="text"></td><td><input class="cantidad" type="number" placeholder="0"></td><td><input class="precio" type="number" placeholder="0"></td><td class="total-fila">$ 0</td>`; return row; }
        function calculateTotals() { totalIngresosGlobal = 0; totalCostosGlobal = 0; totalGastosGlobal = 0; view.querySelectorAll('#ingresos-table tbody tr').forEach(row => { const cantidad = parseFloat(row.querySelector('.cantidad').value) || 0; const precio = parseFloat(row.querySelector('.precio').value) || 0; const totalFila = cantidad * precio; row.querySelector('.total-fila').textContent = formatCurrency(totalFila); totalIngresosGlobal += totalFila; }); view.querySelectorAll('#costos-table tbody tr').forEach(row => { const cantidad = parseFloat(row.querySelector('.cantidad').value) || 0; const precio = parseFloat(row.querySelector('.precio').value) || 0; const totalFila = cantidad * precio; row.querySelector('.total-fila').textContent = formatCurrency(totalFila); totalCostosGlobal += totalFila; }); view.querySelectorAll('#gastos-table tbody tr').forEach(row => { const cantidad = parseFloat(row.querySelector('.cantidad').value) || 0; const precio = parseFloat(row.querySelector('.precio').value) || 0; const totalFila = cantidad * precio; row.querySelector('.total-fila').textContent = formatCurrency(totalFila); totalGastosGlobal += totalFila; }); view.querySelectorAll('.total-ingresos').forEach(el => el.textContent = formatCurrency(totalIngresosGlobal)); view.querySelector('.total-costos').textContent = formatCurrency(totalCostosGlobal); view.querySelector('.total-gastos').textContent = formatCurrency(totalGastosGlobal); const totalEgresos = totalCostosGlobal + totalGastosGlobal; const resultadoFinal = totalIngresosGlobal - totalEgresos; view.querySelector('#total-egresos').textContent = formatCurrency(totalEgresos); const resultadoElement = view.querySelector('#resultado-final'); resultadoElement.textContent = formatCurrency(resultadoFinal); if (resultadoFinal < 0) { resultadoElement.style.color = '#e74c3c'; resultadoElement.textContent += ' (P√©rdida)'; } else { resultadoElement.style.color = '#27ae60'; resultadoElement.textContent += ' (Ganancia)'; } }
        container.addEventListener('click', function(event) { if (event.target.classList.contains('add-row-btn')) { const tableBody = event.target.closest('.section-card').querySelector('tbody'); if (tableBody) { tableBody.appendChild(createRow()); } } });
        container.addEventListener('input', function(event) { if (event.target.classList.contains('cantidad') || event.target.classList.contains('precio')) { calculateTotals(); } });
        view.querySelectorAll('.add-row-btn').forEach(button => { for(let i=0; i<3; i++) button.click(); });
        calculateTotals();
        view.querySelector('#export-btn').addEventListener('click', function() { const wb = XLSX.utils.book_new(); const resumenData = [ ["Concepto", "Monto"], ["Total Ingresos (Ventas)", totalIngresosGlobal], ["Total Costos", totalCostosGlobal], ["Total Gastos", totalGastosGlobal], ["Total Egresos (Costos + Gastos)", totalCostosGlobal + totalGastosGlobal], ["Resultado Mensual", totalIngresosGlobal - (totalCostosGlobal + totalGastosGlobal)] ]; XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(resumenData), "Estado de Resultados"); const getTableData = (tableId, headers) => { const data = [headers]; view.querySelectorAll(`#${tableId} tbody tr`).forEach(row => { const dia = row.cells[0].querySelector('input').value; const concepto = row.cells[1].querySelector('input').value; const cantidad = parseFloat(row.cells[2].querySelector('input').value) || 0; const precio = parseFloat(row.cells[3].querySelector('input').value) || 0; if (dia || concepto || cantidad > 0 || precio > 0) { data.push([dia, concepto, cantidad, precio, cantidad * precio]); } }); return data; }; const ingresosData = getTableData('ingresos-table', ["D√≠a", "Concepto / Art√≠culo", "Cantidad", "Precio ($)", "Venta Total ($)"]); XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(ingresosData), "Ingresos (Ventas)"); const costosData = getTableData('costos-table', ["D√≠a", "Concepto / Art√≠culo", "Cantidad", "Precio ($)", "Costo Total ($)"]); XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(costosData), "Costos"); const gastosData = getTableData('gastos-table', ["D√≠a", "Concepto / Art√≠culo", "Cantidad", "Precio ($)", "Gasto Total ($)"]); XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(gastosData), "Gastos"); const monthName = new Date().toLocaleString('es-ES', { month: 'long' }); const year = new Date().getFullYear(); XLSX.writeFile(wb, `Registro_Negocio_${monthName}_${year}.xlsx`); });
    }
</script>
</body>
</html>
